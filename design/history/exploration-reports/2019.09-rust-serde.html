<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>IPLD Specifications</title>
    <meta name="generator" content="VuePress 1.6.0">
    
    <meta name="description" content="Specifications for the Inter-planetary Linked Data project">
    <link rel="preload" href="/assets/css/0.styles.23f6306d.css" as="style"><link rel="preload" href="/assets/js/app.55c98627.js" as="script"><link rel="preload" href="/assets/js/2.6e37b883.js" as="script"><link rel="preload" href="/assets/js/53.b3d1f46e.js" as="script"><link rel="prefetch" href="/assets/js/10.6e9b9945.js"><link rel="prefetch" href="/assets/js/11.4b005f70.js"><link rel="prefetch" href="/assets/js/12.6b4fd756.js"><link rel="prefetch" href="/assets/js/13.3bf06090.js"><link rel="prefetch" href="/assets/js/14.feeb2eb5.js"><link rel="prefetch" href="/assets/js/15.29109304.js"><link rel="prefetch" href="/assets/js/16.4c05125c.js"><link rel="prefetch" href="/assets/js/17.9c7bd77a.js"><link rel="prefetch" href="/assets/js/18.91aad06b.js"><link rel="prefetch" href="/assets/js/19.314e2f7c.js"><link rel="prefetch" href="/assets/js/20.0e9a842d.js"><link rel="prefetch" href="/assets/js/21.3cc9715f.js"><link rel="prefetch" href="/assets/js/22.3457d32b.js"><link rel="prefetch" href="/assets/js/23.5b6bb7aa.js"><link rel="prefetch" href="/assets/js/24.a7e2cb99.js"><link rel="prefetch" href="/assets/js/25.37b51f7e.js"><link rel="prefetch" href="/assets/js/26.f2876268.js"><link rel="prefetch" href="/assets/js/27.5071a54f.js"><link rel="prefetch" href="/assets/js/28.3dc04ba6.js"><link rel="prefetch" href="/assets/js/29.a558e6fd.js"><link rel="prefetch" href="/assets/js/3.db7c5fbd.js"><link rel="prefetch" href="/assets/js/30.56ea4153.js"><link rel="prefetch" href="/assets/js/31.b07c9b3a.js"><link rel="prefetch" href="/assets/js/32.a1a32878.js"><link rel="prefetch" href="/assets/js/33.cd903a17.js"><link rel="prefetch" href="/assets/js/34.dfbda8ba.js"><link rel="prefetch" href="/assets/js/35.1e09c419.js"><link rel="prefetch" href="/assets/js/36.faeb9e62.js"><link rel="prefetch" href="/assets/js/37.88df1d15.js"><link rel="prefetch" href="/assets/js/38.ae4ca400.js"><link rel="prefetch" href="/assets/js/39.20314f5a.js"><link rel="prefetch" href="/assets/js/4.c5691fe7.js"><link rel="prefetch" href="/assets/js/40.9509f637.js"><link rel="prefetch" href="/assets/js/41.9dfaa7fc.js"><link rel="prefetch" href="/assets/js/42.b7ce3cd5.js"><link rel="prefetch" href="/assets/js/43.3c11440b.js"><link rel="prefetch" href="/assets/js/44.ea9bc079.js"><link rel="prefetch" href="/assets/js/45.f79cf9a5.js"><link rel="prefetch" href="/assets/js/46.be54a361.js"><link rel="prefetch" href="/assets/js/47.924a22ca.js"><link rel="prefetch" href="/assets/js/48.bb5c3af2.js"><link rel="prefetch" href="/assets/js/49.8a05d108.js"><link rel="prefetch" href="/assets/js/5.756fa39f.js"><link rel="prefetch" href="/assets/js/50.a747f703.js"><link rel="prefetch" href="/assets/js/51.cf511476.js"><link rel="prefetch" href="/assets/js/52.2920aec5.js"><link rel="prefetch" href="/assets/js/54.a6d078c9.js"><link rel="prefetch" href="/assets/js/55.9dc92101.js"><link rel="prefetch" href="/assets/js/56.82cbcea9.js"><link rel="prefetch" href="/assets/js/57.4558afa7.js"><link rel="prefetch" href="/assets/js/58.fc599073.js"><link rel="prefetch" href="/assets/js/59.6afe14f2.js"><link rel="prefetch" href="/assets/js/6.1e789981.js"><link rel="prefetch" href="/assets/js/60.84bc7a69.js"><link rel="prefetch" href="/assets/js/61.3e6d4220.js"><link rel="prefetch" href="/assets/js/62.9d903bb3.js"><link rel="prefetch" href="/assets/js/63.e8b9f3c6.js"><link rel="prefetch" href="/assets/js/64.d2c107aa.js"><link rel="prefetch" href="/assets/js/65.8b7893c4.js"><link rel="prefetch" href="/assets/js/66.a5e90409.js"><link rel="prefetch" href="/assets/js/67.e9031adc.js"><link rel="prefetch" href="/assets/js/68.95c237c4.js"><link rel="prefetch" href="/assets/js/69.d39d42a5.js"><link rel="prefetch" href="/assets/js/7.fe00b891.js"><link rel="prefetch" href="/assets/js/70.65331ecd.js"><link rel="prefetch" href="/assets/js/71.d4cf3ee2.js"><link rel="prefetch" href="/assets/js/72.f2d01840.js"><link rel="prefetch" href="/assets/js/73.47cb9839.js"><link rel="prefetch" href="/assets/js/74.836985a7.js"><link rel="prefetch" href="/assets/js/75.c09b9f95.js"><link rel="prefetch" href="/assets/js/76.430c36a3.js"><link rel="prefetch" href="/assets/js/77.11d8ce65.js"><link rel="prefetch" href="/assets/js/78.daddf904.js"><link rel="prefetch" href="/assets/js/79.c3063aec.js"><link rel="prefetch" href="/assets/js/8.9a302c13.js"><link rel="prefetch" href="/assets/js/80.94706365.js"><link rel="prefetch" href="/assets/js/81.adeed8b0.js"><link rel="prefetch" href="/assets/js/82.1b2ac99b.js"><link rel="prefetch" href="/assets/js/83.13872bf4.js"><link rel="prefetch" href="/assets/js/84.20ad0c76.js"><link rel="prefetch" href="/assets/js/85.6fa07bb2.js"><link rel="prefetch" href="/assets/js/86.5b24f24a.js"><link rel="prefetch" href="/assets/js/9.bb45edf0.js">
    <link rel="stylesheet" href="/assets/css/0.styles.23f6306d.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">IPLD Specifications</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link">
  Home
</a></div><div class="nav-item"><a href="/schemas/" class="nav-link">
  IPLD Schemas
</a></div> <a href="https://github.com/ipld/specs" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <svg xmlns="http://www.w3.org/2000/svg" aria-labelledby="outbound-link-title" role="img" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><title id="outbound-link-title">(opens new window)</title> <path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link">
  Home
</a></div><div class="nav-item"><a href="/schemas/" class="nav-link">
  IPLD Schemas
</a></div> <a href="https://github.com/ipld/specs" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <svg xmlns="http://www.w3.org/2000/svg" aria-labelledby="outbound-link-title" role="img" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><title id="outbound-link-title">(opens new window)</title> <path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span></span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/design/history/exploration-reports/2019.09-rust-serde.html#missing-cbor-tags-support-in-serde-cbor" class="sidebar-link">Missing CBOR tags support in serde_cbor</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/design/history/exploration-reports/2019.09-rust-serde.html#tags-support-in-serde" class="sidebar-link">Tags support in Serde</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/design/history/exploration-reports/2019.09-rust-serde.html#conclusion" class="sidebar-link">Conclusion</a><ul class="sidebar-sub-headers"></ul></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="using-serde-for-rust-ipld"><a href="#using-serde-for-rust-ipld" class="header-anchor">#</a> Using Serde for Rust IPLD</h1> <p><strong>Author</strong>: Volker Mische (<a href="https://github.com/vmx/" target="_blank" rel="noopener noreferrer">@vmx<svg xmlns="http://www.w3.org/2000/svg" aria-labelledby="outbound-link-title" role="img" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><title id="outbound-link-title">(opens new window)</title> <path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>)</p> <p>It sounds like a great idea using <a href="https://serde.rs/" target="_blank" rel="noopener noreferrer">Serde<svg xmlns="http://www.w3.org/2000/svg" aria-labelledby="outbound-link-title" role="img" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><title id="outbound-link-title">(opens new window)</title> <path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> as basis for Rust IPLD. It should be simply to put the <a href="https://github.com/ipld/specs/blob/67028313e0793d562d671a7fb4a030f471f90098/data-model-layer/data-model.md" target="_blank" rel="noopener noreferrer">IPLD Data Model<svg xmlns="http://www.w3.org/2000/svg" aria-labelledby="outbound-link-title" role="img" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><title id="outbound-link-title">(opens new window)</title> <path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> on top of the <a href="https://serde.rs/data-model.html" target="_blank" rel="noopener noreferrer">Serde Data Model<svg xmlns="http://www.w3.org/2000/svg" aria-labelledby="outbound-link-title" role="img" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><title id="outbound-link-title">(opens new window)</title> <path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>. So I was looking into implementing DagCbor on top of <a href="https://github.com/pyfisch/cbor" target="_blank" rel="noopener noreferrer">serde_cbor<svg xmlns="http://www.w3.org/2000/svg" aria-labelledby="outbound-link-title" role="img" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><title id="outbound-link-title">(opens new window)</title> <path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>.</p> <h2 id="missing-cbor-tags-support-in-serde-cbor"><a href="#missing-cbor-tags-support-in-serde-cbor" class="header-anchor">#</a> Missing CBOR tags support in serde_cbor</h2> <p>The blocking issue is that there's no CBOR tags support in serde_cbpr. <a href="https://github.com/dignifiedquire/" target="_blank" rel="noopener noreferrer">@dignifiedquire<svg xmlns="http://www.w3.org/2000/svg" aria-labelledby="outbound-link-title" role="img" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><title id="outbound-link-title">(opens new window)</title> <path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> did an implementation for tags support. I couldn't get it working (due to not being familiar with Serde yet) for deserializing things into custom types. The plan was to serialize CBOR tag 42 into a &quot;CID struct&quot;. I looked for other formats that are hitting the same limitation in Serde.</p> <p><a href="https://msgpack.org/" target="_blank" rel="noopener noreferrer">msgpack<svg xmlns="http://www.w3.org/2000/svg" aria-labelledby="outbound-link-title" role="img" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><title id="outbound-link-title">(opens new window)</title> <path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> has the notion of <a href="https://github.com/msgpack/msgpack/blob/1e4fd94b90d38167b8b5a0ecf57f59b538669574/spec.md#extension-types" target="_blank" rel="noopener noreferrer">Extensions<svg xmlns="http://www.w3.org/2000/svg" aria-labelledby="outbound-link-title" role="img" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><title id="outbound-link-title">(opens new window)</title> <path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> and there's also an implemention for Serde (<a href="https://github.com/3Hren/msgpack-rust" target="_blank" rel="noopener noreferrer">msgpack-rust<svg xmlns="http://www.w3.org/2000/svg" aria-labelledby="outbound-link-title" role="img" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><title id="outbound-link-title">(opens new window)</title> <path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>) which even gained <a href="https://github.com/3Hren/msgpack-rust/pull/216" target="_blank" rel="noopener noreferrer">extension support recently<svg xmlns="http://www.w3.org/2000/svg" aria-labelledby="outbound-link-title" role="img" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><title id="outbound-link-title">(opens new window)</title> <path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>. So I used that as a basis to create yet another implementation of CBOR tags support for serde_cbor (<a href="https://github.com/pyfisch/cbor/pull/151" target="_blank" rel="noopener noreferrer">#151<svg xmlns="http://www.w3.org/2000/svg" aria-labelledby="outbound-link-title" role="img" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><title id="outbound-link-title">(opens new window)</title> <path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>). If you want to learn more about this approach, checkout the discussions at <a href="https://github.com/serde-rs/serde/issues/529" target="_blank" rel="noopener noreferrer">#529: Implementing custom type serializing<svg xmlns="http://www.w3.org/2000/svg" aria-labelledby="outbound-link-title" role="img" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><title id="outbound-link-title">(opens new window)</title> <path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>.</p> <p>I'm happy with the result and finally have a way better understanding of Serde. I now also understand why merging a PR following that approach would be problematic. You could serialize and deserialize CBOR tags with it, but there won't be any interoperability with e.g. rust-msgpack. You couldn't simply have a single implementation of a CID type that would work with CBOR as well as with msgpack. Though, I've created a <a href="https://github.com/vmx/rust-ipld-dag-cbor" target="_blank" rel="noopener noreferrer">prototype<svg xmlns="http://www.w3.org/2000/svg" aria-labelledby="outbound-link-title" role="img" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><title id="outbound-link-title">(opens new window)</title> <path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> that can serialize/deserialize the IPLD Date Model into CBOR using the patched serde_cbor.</p> <p>So what would be needed in order to have it properly work with Serde?</p> <h2 id="tags-support-in-serde"><a href="#tags-support-in-serde" class="header-anchor">#</a> Tags support in Serde</h2> <p>There has been plenty of discussions ways in order to get tags support as needed by formats like CBOR or msgpack into Serde. Here I try to give a bit of that history and the summary.</p> <p>The starting point is <a href="https://github.com/serde-rs/serde/issues/163" target="_blank" rel="noopener noreferrer">#163: CBOR support<svg xmlns="http://www.w3.org/2000/svg" aria-labelledby="outbound-link-title" role="img" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><title id="outbound-link-title">(opens new window)</title> <path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>, where the author of serde_cbor asks if it would be possible to add a <code>visit_tag()</code> method to Serde to support the tags use case. Following this idea a <a href="https://github.com/serde-rs/serde/pull/301" target="_blank" rel="noopener noreferrer">#301: WIP: Parsing and emitting tagged values<svg xmlns="http://www.w3.org/2000/svg" aria-labelledby="outbound-link-title" role="img" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><title id="outbound-link-title">(opens new window)</title> <path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> is opened which starts adding support for serializing and deserializing tags. The discussion is about types that tags need to support, CBOR Tags are integers, YAML tags are strings. And also about the problem of different tags for the same data type in different formats.</p> <p>There is no conclusion, but that issues is superseded by <a href="https://github.com/serde-rs/serde/pull/408" target="_blank" rel="noopener noreferrer">#408: Add support for tagged values.<svg xmlns="http://www.w3.org/2000/svg" aria-labelledby="outbound-link-title" role="img" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><title id="outbound-link-title">(opens new window)</title> <path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>, which contains a full implementation. It seems to solve the problem, but a discussion starts, whether there are better ways to implement tags. A proposed solution is to use <a href="https://github.com/rust-lang/rust/issues/31844" target="_blank" rel="noopener noreferrer">specialization<svg xmlns="http://www.w3.org/2000/svg" aria-labelledby="outbound-link-title" role="img" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><title id="outbound-link-title">(opens new window)</title> <path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>.</p> <p>That idea is further pursued in <a href="https://github.com/serde-rs/serde/pull/455" target="_blank" rel="noopener noreferrer">#455: Tagged values through specialization<svg xmlns="http://www.w3.org/2000/svg" aria-labelledby="outbound-link-title" role="img" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><title id="outbound-link-title">(opens new window)</title> <path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>. After some discussion it reaches the point where the specialization doesn't work. Bug <a href="https://github.com/rust-lang/rust/issues/38516" target="_blank" rel="noopener noreferrer">#38516: Specialization does not find the default impl<svg xmlns="http://www.w3.org/2000/svg" aria-labelledby="outbound-link-title" role="img" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><title id="outbound-link-title">(opens new window)</title> <path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> was opened almost 3 years ago, but didn't find any attention.</p> <h2 id="conclusion"><a href="#conclusion" class="header-anchor">#</a> Conclusion</h2> <p>I still like the idea of being able to use Serde for the Rust IPLD work. The chances are high that there is already a parser for for the file format you want to use, you would just need to implement make sure IPLD Data Model types can be (de)serialized.</p> <p>But in order to make this happen, we need tag support within Serde. I will try to revive the idea outlined in <a href="https://github.com/serde-rs/serde/pull/408" target="_blank" rel="noopener noreferrer">#408: Add support for tagged values.<svg xmlns="http://www.w3.org/2000/svg" aria-labelledby="outbound-link-title" role="img" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><title id="outbound-link-title">(opens new window)</title> <path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>, Without tag support there's no real benefit of using Serde and we would be better off having specialized parsers for each format we want to support. The result would then probably resemble Serde, but less flexible and specific to the IPLD Data Model.</p></div> <footer class="page-edit"><div class="edit-link"><a href="https://github.com/ipld/specs/edit/master/design/history/exploration-reports/2019.09-rust-serde.md" target="_blank" rel="noopener noreferrer">Edit this page on GitHub</a> <svg xmlns="http://www.w3.org/2000/svg" aria-labelledby="outbound-link-title" role="img" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><title id="outbound-link-title">(opens new window)</title> <path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></div> <div class="last-updated"><span class="prefix">Last Updated:</span> <span class="time">10/8/2020, 9:07:09 PM</span></div></footer> <!----> </main></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.55c98627.js" defer></script><script src="/assets/js/2.6e37b883.js" defer></script><script src="/assets/js/53.b3d1f46e.js" defer></script>
  </body>
</html>
